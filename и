const TelegramBot = require('node-telegram-bot-api');
const express = require('express');

const app = express();
const PORT = process.env.PORT || 3000;

// Ð‘Ð¾Ñ‚Ñ€Ð¾ Ð¾Ò“Ð¾Ð· ÐºÑƒÐ½
const token = process.env.TELEGRAM_TOKEN;
const bot = new TelegramBot(token, { polling: true });

// Ð‘Ð°Ñ€Ð¾Ð¸ Ð½Ð¸Ð³Ð¾Ò³ Ð´Ð¾ÑˆÑ‚Ð°Ð½Ð¸ ÑÐµÑ€Ð²ÐµÑ€ Ñ„Ð°ÑŠÐ¾Ð»
app.get('/', (req, res) => {
  res.json({ 
    status: 'Bot is running!', 
    time: new Date().toISOString(),
    message: 'Telegram Bot is active'
  });
});

// Ð¤Ð°ÑŠÐ¾Ð»Ð¸ÑÑ‚Ð¸ Ð±Ð¾Ñ‚
bot.onText(/\/start/, (msg) => {
  const chatId = msg.chat.id;
  bot.sendMessage(chatId, 'Ð¡Ð°Ð»Ð¾Ð¼! Ð‘Ð¾Ñ‚ ÐºÐ¾Ñ€ Ð¼ÐµÐºÑƒÐ½Ð°Ð´ âœ…\nÐœÐ°Ð½ Ð´Ð°Ñ€ Railway ÐºÐ¾Ñ€ Ð¼ÐµÐºÑƒÐ½Ð°Ð¼!');
});

bot.on('message', (msg) => {
  const chatId = msg.chat.id;
  if (msg.text && !msg.text.startsWith('/')) {
    bot.sendMessage(chatId, `Ð¨ÑƒÐ¼Ð¾ Ð½Ð°Ð²Ð¸ÑˆÑ‚ÐµÐ´: "${msg.text}"`);
  }
});

// Ð¡ÐµÑ€Ð²ÐµÑ€Ñ€Ð¾ Ð¾Ò“Ð¾Ð· ÐºÑƒÐ½
app.listen(PORT, '0.0.0.0', () => {
  console.log(`ðŸš€ Bot server running on port ${PORT}`);
  console.log(`âœ… Telegram Bot is active and listening...`);
});
